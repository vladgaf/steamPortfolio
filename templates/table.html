{%extends "main.html"%}
{%block table%}
<script src="{{url_for('static', filename = 'scripts/modal.js')}}"></script>
<div class="tableWrapper">


    <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start bg-dark">
        <a href="/" class="d-flex align-items-center mb-2 mb-lg-0 text-white text-decoration-none">
            <svg class="bi me-2" width="40" height="32" role="img" aria-label="Bootstrap">
                <use xlink:href="#bootstrap"></use>
            </svg>
        </a>

        <ul class="nav col-12 col-lg-auto me-lg-auto mb-2 justify-content-center mb-md-0 ">
            <li>
                <div class="nav-link px-2 text-white">
                    <div class="fs-4 text-white">{{ totalInvested|round(2, 'floor') }}</div>
                    <div class="fs-6 text-white-50">Total invested:</div>
                </div>
            </li>

            <li>
                <div class="nav-link px-2 text-white">
                    <div class="fs-4 text-white">{{ totalWorthNow|round(2, 'floor') }}</div>
                    <div class="fs-6 text-white-50">Total worth now:</div>
                </div>
            </li>

            <li>
                <div class="nav-link px-2 text-white">
                    {%if (totalWorthNow - totalInvested) > 0 %}
                    <div class="fs-4 text-success">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                             class="bi bi-arrow-up-square" viewBox="0 0 16 16">
                            <path d="m7.247 4.86-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z"/>
                        </svg>
                        {{ (totalWorthNow - totalInvested)|round(2, 'floor') }}
                    </div>
                    {%else%}
                    <div class="fs-4 text-danger">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                             class="bi bi-arrow-down-square" viewBox="0 0 16 16">
                            <path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"/>
                        </svg>
                        {{ (totalWorthNow - totalInvested)|round(2, 'floor') }}
                    </div>
                    {%endif%}
                    <div class="fs-6 text-white-50">Difference:</div>
                </div>
            </li>
        </ul>


        <div class="text-end">
            <form name='refreshValues' action="" method="post">
                <input type="submit" class="btn btn-outline-light me-2" name="refreshInventory"
                       value="Refresh inventory">
                <input type="submit" class="btn btn-outline-light me-2" name="refreshPrices" value="Refresh prices">
            </form>
        </div>
    </div>

    <table class="table table-striped table-dark">
        <thead class="thead-dark mb-2">
        <tr>
            <th scope="col"></th>
            <th scope="col">Name</th>
            <th scope="col">Quantity</th>
            <th scope="col">Bought for</th>
            <th scope="col">Total Invested</th>
            <th scope="col">Current price</th>
            <th scope="col">Total Worth</th>
            <th scope="col">Difference</th>
            <th scope="col"></th>
        </tr>
        </thead>
        <tbody>
        {% for item in userItems %}
        <tr>
            <td></td>
            <td> {{ item["itemName"] }}</td>
            <td> {{ item["quantity"] }}</td>
            <td>
                <div class="d-flex align-items-center" style="gap:10px;">
                    <form name='{{item["id"]}}' action="" method="post">
                        <input type="hidden" name="itemName" value='{{ item["itemName"] }}' readonly>
                        <input type="text"
                               class='bg-dark text-white border border-secondary btn-outline-warning rounded btn-secondary btn-sm mr-4'
                               name="boughtPrice" value='{{ item["boughtPrice"] }}'>
                        <input type="submit" class="btn btn-primary btn-sm" value="Save">
                    </form>
                </div>
            </td>
            </form>
            <td>{{item["quantity"] * item["boughtPrice"]}}</td>
            {%if ( item["currentPrice"] - item["boughtPrice"]) > 0 %}
            <td class="text-success">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                     class="bi bi-arrow-up-square" viewBox="0 0 16 16">
                    <path d="m7.247 4.86-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z"/>
                </svg>
                {{ item["currentPrice"] }}
            </td>
            {%else%}
            <td class="text-danger">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                     class="bi bi-arrow-down-square" viewBox="0 0 16 16">
                    <path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"/>
                </svg>
                {{ item["currentPrice"] }}
            </td>
            {%endif%}
            <td>{{ (item["quantity"] * item["currentPrice"])|round(2, 'floor')}}</td>
            {%if (item["quantity"] * item["currentPrice"] - item["quantity"] * item["boughtPrice"]) > 0 %}

            <td class="text-success">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                     class="bi bi-arrow-up-square" viewBox="0 0 16 16">
                    <path d="m7.247 4.86-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z"/>
                </svg>
                {{ (item["quantity"] * item["currentPrice"] - item["quantity"] * item["boughtPrice"])|round(2, 'floor')
                }}
            </td>
            {%else%}
            <td class="text-danger">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                     class="bi bi-arrow-down-square" viewBox="0 0 16 16">
                    <path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"/>
                </svg>
                {{ (item["quantity"] * item["currentPrice"] - item["quantity"] * item["boughtPrice"])|round(2, 'floor')
                }}
            </td>
            {%endif%}
            <td>
                <form id='{{item["id"]}}' action="" method="post">
                    <input type="hidden" name="itemName" value='{{ item["itemName"] }}' readonly>
                    <input type="submit" class="btn btn-outline-light me-2" name="itemDetails" value="Details">
                </form>
            </td>
        </tr>
        {%endfor%}
        </tbody>
    </table>
</div>
{%endblock%}